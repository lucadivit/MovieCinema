<?php/** * Le classi View permettono l'interazione con l'utente in particolare VHome si occupa di definire le diverse home degli utenti. * Estende la classe View * @author Luca & Valentina * @package View * @category Home */class VHome extends View {    /**     * Questo metodo imposta e stampa la pagina principale visibile da tutti i tipi di utenti     * @access public     * @return mixed template     */    public function impostapagprincipale(){                $slider=$this->recuperodatislider();        $menuhome = $this->fetch('./smarty/smarty-dir/templates/Menu_Home.tpl');        $this->assign('Menu', $menuhome);        $this->assign('slider', $slider);        $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Pagina_Guest.tpl');        return $tpl1;    }        /**     * Funzione per il reperimento di locandine, titoli e media dei voti per la pagina dell'ospite     * @return boolean     */    public function recuperodatislider(){                $c_home = USingleton::getInstaces('CHome');        $c_gest = USingleton::getInstaces('CGestione');        $dati = $c_gest->datiSala();        //$dati_unique = array_map("unserialize", array_unique(array_map("serialize", $dati)));        $film = array();        $i=0;        if($dati){        foreach ($dati as $value) {            $film[$i]['titolo']=$value['titolo_film'];            $film[$i]['locandina']=$c_gest->cercalocandina($value['codice_film']);             $film[$i]['media']=$c_home->mediavoto($value['codice_film']);            $i++;        }        //serve per eliminare i duplicati perchè un film può stare in più sale        $dati_unique = array_map("unserialize", array_unique(array_map("serialize", $film)));        $ris=array();        $i=0;        //gli indici delle immagini non ripetute non sono in ordine. se ad esempio ho a[0]='titolo1', a[1]='titolo1',        //a[2]='titolo2' restituisce a[1] e a[2] quindi a[0] che sta sul tpl risulta vuoto e non si vede        foreach ($dati_unique as $dato){            $ris[$i]=$dato;            $i++;        }       return $ris;        }else{            return false;        }    }  /**     * Questo metodo imposta la pagina principale del guest, dell'amministratore e dell'utente     * @access public     * @return mixed template     */       public function impostapaginaguest() {        $c_aut = USingleton::getInstaces('CAutenticazione');        $logged = $c_aut->UtenteLoggedIn();      if ($logged=='home') {            $tpl1= $this->assegnamenu('./smarty/smarty-dir/templates/Menu_Home.tpl');                     } else if($logged=='user'){            $nome=$c_aut->ciaoutente();                   $this->assign('nome', $nome);            $tpl1= $this->assegnamenu('./smarty/smarty-dir/templates/Menu_Utente.tpl');        }            else{            $nome=$c_aut->ciaoutente();            $this->assign('nome', $nome);            $tpl1= $this->assegnamenu('./smarty/smarty-dir/templates/Menu_Admin.tpl');        }                    $slider=$this->recuperodatislider();            $this->assign('slider', $slider);            $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Home_page.tpl');        return $tpl1;    }         /**     * assegna il menu all'home page     * @access public     * @param String $tpl template da prelevare     * @return mixed template     */    public function assegnamenu($tpl){        $menuhome = $this->fetch($tpl);        $this->assign('Menu', $menuhome);        $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Home_page.tpl');        return $tpl1;    }    /** * Assegna menu e slider alla pagina guest      * @access public     * @param String $tpl template da prelevare     * @return mixed template     */       public function paginaguest($tpl){$slider=  $this->recuperodatislider();        $menuhome = $this->fetch($tpl);        $this->assign('Menu', $menuhome);        $this->assign('slider', $slider);        $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Pagina_Guest.tpl');        return $tpl1;    }     /**     * Questa funzione permette di assegnare il menu alla pagina di login errato      *      * @access public     * @return mixed tempalte     */    public function impostapaginaerrore() {        $menuhome = $this->fetch('./smarty/smarty-dir/templates/Menu_Home.tpl');        $this->assign('Menu', $menuhome);        $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Login_Errato.tpl');        return $tpl1;    }            /**     *imposta lo slider e il menu alla home dell'amministratore     * @access public     * @return mixed template     */    public function impostapaginaadmin() {       $c_aut = USingleton::getInstaces('CAutenticazione');        $slider=$this->recuperodatislider();                 $nome=$c_aut->ciaoutente();        $this->assign('nome', $nome);        $menuadmin = $this->fetch('./smarty/smarty-dir/templates/Menu_Admin.tpl');        $this->assign('Menu', $menuadmin);        $this->assign('slider', $slider);        $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Pagina_Guest.tpl');        return $tpl1;    }    /**     * assegna slider e menu alla home dell'utente     * @return mixed template     */    public function impostapaginautente() {        $c_aut = USingleton::getInstaces('CAutenticazione');         $slider=$this->recuperodatislider();        $nome=$c_aut->ciaoutente();        $this->assign('nome', $nome);        $menuut = $this->fetch('./smarty/smarty-dir/templates/Menu_Utente.tpl');        $this->assign('Menu', $menuut);        $this->assign('slider', $slider);        $tpl1 = $this->fetch('./smarty/smarty-dir/templates/Pagina_Guest.tpl');             return $tpl1;    }      /**     * Questa funzione imposta la pagine di primo accesso per l'utente     * @access public     * @return mixed tempalte     */    public function impostapaginaprimoaccesso() {        $primoaccesso = $this->fetch('./smarty/smarty-dir/templates/Primo_Accesso.tpl');        $this->assign('primoaccesso', $primoaccesso);        $tpl1=$this->fetch('./smarty/smarty-dir/templates/prova.tpl');        return $tpl1;    }}